# IP Addressing의 이해

## 들어가기 (Introduction)

네트워크에서 IP 주소는 마치 우리 실생활의 주소처럼, 각 장치를 식별하고 데이터를 전달하는 핵심 요소입니다.

### IP 주소의 중요성
- 인터넷상의 모든 장치를 식별하는 고유한 주소
- 데이터 패킷의 목적지를 결정하는 라우팅의 기준
- 전 세계 네트워크를 하나로 연결하는 핵심 프로토콜

### 현재 IP 체계의 도전과제
- IPv4 주소 고갈 문제
- IPv6로의 전환 필요성
- 사설 네트워크와 NAT의 광범위한 사용

### 학습 목표
- IP 주소(IPv4/IPv6)의 기본 구조 이해
- 서브넷팅을 통한 네트워크 분할 방법 습득
- 사설 IP와 공인 IP의 차이점 파악
- NAT의 동작 원리와 활용 방법 학습
- 실제 네트워크 환경에서 IP 관련 명령어 활용

## IP 주소 개념 (IPv4 vs IPv6)

### IPv4 주소 구조

#### 기본 구조
- 32비트 주소 체계(2^32 = 약 43억개 주소)
- 8비트씩 4개의 옥뎃으로 구성(예: 192.168.0.1)
- 각 옥텟은 0~255 범위의 10진수로 표현

#### 클래스 기반 주소 체계
- Class A: 0.0.0.0 ~ 127.255.255.255(/8)
- Class B: 128.0.0.0 ~ 191.255.255.255(/16)
- Class C: 192.0.0.0 ~ 233.255.255.255(/24)
- Class D: 224.0.0.0 ~ 239.255.255.255(멀티캐스트)
- Class E: 240.0.0.0 ~ 255.255.255.255(예약)

#### 클래스리스(CIDR) 주소 체계
- 클래스 경계에 구애받지 않는 유연한 주소 할당
- CIDR 표기법 사용(예: 192.168.1.0/24)
- 네트워크 크기를 비트 단위로 자유롭게 지정

### IPv6 주소 구조

#### 기본 구조
- 128비트 주소 체계(2^128개의 주소 공간)
- 16비트씩 8개 그룹으로 구성
- 각 그룹은 4자리 16진수로 표현 (예: 2001:0db8:85a3:0000:0000:8a2e:0370:7334)

#### 주소 표기법
- 콜론(:)으로 그룹 구분
- 앞자리 0 생략 가능 (0db8 = db8)
- 연속된 0 그룹은 "::"으로 한 번만 축약 가능 예: 2001:0db8:0000:0000:0000:0000:0000:0001 → 2001:db8::1

#### 주소 유형
- 유니캐스트: 단일 인터페이스 식별
- 멀티캐스트: 그룹 통신용
- 애니캐스트: 가장 가까운 노드로 라우팅

### IPv4 vs IPv6 다이어그램

<img src="https://www.networkacademy.io/sites/default/files/inline-images/ipv4-vs-ipv6.png">

## IP 주소 할당 방식

### 사설 IP vs 공인 IP

#### 공인 IP(Public IP)
- 인터넷 상에서 직접 통신 가능한 고유 주소
- ISP로부터 할당받은 전 세계적으로 유일한 주소
- 인터넷 서버 운영 시 필수
- 고정 비용 발생

#### 사설 IP(Private IP)
- RFC 1918에서 정의된 내부 네트워크용 주소
- 사설 IP 대역:
    - Class A: 10.0.0.0 ~ 10.255.255.255
    - Class B: 172.16.0.0 ~ 172.31.255.255
    - Class C: 192.168.0.0 ~ 192.168.255.255

- 내부 네트워크에서만 유효
- 인터넷 통신 시 NAT 필요

### 고정 IP vs 동적 IP (DHCP)

#### 고정 IP (Static IP)
- 수동으로 설정하는 변경되지 않는 IP 주소
- 주요 용도:
    - 서버/네트워크 장비
    - 프린터/NAS등 네트워크 자원
    - 보안이 중요한 시스템

- 장점: 주소 변경 없음, 안정성
- 단점: 수동 관리 필요, 주소 낭비 가능

#### 동적 IP(Dynamic IP)
- DHCP를 통해 자동으로 할당받는 IP주소
- DHCP 동작 과정:
    1. DISCOVER: 클라이언트가 DHCP 서버 탐색
    2. OFFER: DHCP 서버가 사용 가능한 IP 제안
    3. REQUEST: 클라이언트가 제안된 IP 요청
    4. ACK: DHCP 서버가 IP 사용 승인

- 장점: 자동 관리, IP 재사용 가능
- 단점: 주소가 변경될 수 있음

### DHCP 동작 과정

<img src="https://cdn.fiberroad.com/app/uploads/2023/02/How-does-DHCP-work-1024x346.png">

## 서브넷팅과 CIDR

### 서브넷 마스크, CIDR(Block 사이즈)

#### 서브넷 마스크 기본 개념
- IP 주소를 네트워크부와 호스트부로 구분
- 255.255.255.0 형태로 표현 (/24와 동일)
- 1로 된 비트는 네트워크부, 0으로 된 비트는 호스트부

#### CIDR 표기법
- /숫자 형태로 표현(예: /24, /26)
- 숫자는 네트워크 비트 수를 의미
- 주요 CIDR 블록:
    - /24: 255.255.255.0(256개 주소)
    - /25: 255.255.255.128(128개 주소)
    - /26: 255.255.255.192(64개 주소)
    - /27: 255.255.255.224(32개 주소)

### 서브넷 계산 예시

#### 192.168.1.0/24 네트워크를 /26으로 분할
- 원본: 192.168.1.0/24 (256개 주소)
- 분할 후:
    - 1번 서브넷: 192.168.1.0/26 (0 ~ 63)
    - 2번 서브넷: 192.168.1.64/26(64 ~ 127)
    - 3번 서브넷: 192.168.1.128/26(128 ~ 191)
    - 4번 서브넷: 192.168.1.192/26(192 ~ 255)

#### 각 서브넷 구성
- 네트워크 주소: 첫 번째 주소
- 사용 가능한 호스트: 네트워크주소 + 1 ~ 브로드캐스트 - 1
- 브로드캐스트 주소: 마지막 주소

### VLSM, 서브넷 설계 팁

#### VLSM(Variable Length Subnet Mask)
- 서브넷마다 다른 크기의 마스크 사용
- 네트워크 규모에 따라 효율적인 주소 할당
- 예시:
    - 대형 부서: /24(254대)
    - 중형 부서: /25(126대)
    - 소형 부서: /26(62대)

#### 서브넷 설계 팁
- 향후 확장성 고려
- 주요 네트워크는 쉬운 주소 할당
- 브로드캐스트 도메인 크기 고려
- 라우팅 테이블 단순화 고려

### 서브넷 마스크 분할 과정 다이어그램

<img src="https://media.geeksforgeeks.org/wp-content/uploads/20230714184807/Subnet-Cheat-Sheet.png">

## NAT와 사설망

### NAT 동작 원리

#### NAT(Network Address Translation) 개념
- 사설 IP 주소를 공인 IP 주소로 변환
- 내부 네트워크와 외부 인터넷 간의 통신 중개
- IP 주소 부족 문제 해결 방안

#### NAT 유형
- Static NAT: 1:1 고정 매핑
    - 내부 IP와 외부 IP가 1:1로 매핑
    - 서버 운영 시 주로 사용

- Dynamic NAT: N:M 동적 매핑
    - 다수의 내부 IP가 다수의 외부 IP로 동적 변환
    - 사용 가능한 공인 IP 풀에서 할당

### 포트포워딩, PAT(Port Address Translation)

#### PAT 동작
- 여러 내부 IP가 하나의 공인 IP 공유
- 포트 번호로 각 연결 구분
- 예시:
    - 192.168.1.10:3000 -> 203.0.113.1:40000
    - 192.168.1.20:80 -> 203.0.113.1.40001

#### 포트포워딩
- 특정 포트의 외부 접속을 내부 서버로 전달
- 주요 사용 사례:
    - 웹 서버(80/443)
    - 게임서버
    - 원격접속(SSH/RDP)

### 공인 IP 절약과 보안

#### IP 절약 효과
- 하나의 공인 IP로 다수의 내부 호스트 수용
- IPv4 주소 고갈 문제 완화
- 비용 절감 효과

#### 보안 이점
- 내부 네트워크 구조 은닉
- 외부에서 직접 접근 차단
- 내부 호스트 보호

### NAT/PAT 동작 과정 다이어그램

<img src="https://velog.velcdn.com/images/yange/post/f287487d-f968-41f4-910f-8ea5944edb77/image.png">

## IP 관련 명령어와 실습

### ipconfig/ifconfig

#### Windows에서의 IP 설정 확인(ipconfig)
```cmd
ipconfig /all
```
- 주요 출력 정보:
    - IPv4 주소
    - 서브넷 마스크
    - 기본 게이트웨이
    - DNS 서버
    - DHCP 서버

#### Linux/Unix에서의 IP 설정 확인
```bash
# 기존 명령어
ifconfig

# 최신 명령어
ip addr show
```
- 주요 출력 정보:
    - 네트워크 인터페이스 목록
    - IP 주소와 넷마스크
    - MAC 주소
    - 인터페이스 상태

### ping, traceroute (ICMP 활용)

#### ping 명령어
```bash
# Windows/Linux 공통
ping 8.8.8.8
ping www.google.com
```
- 용도:
    - 네트워크 연결성 테스트
    - 응답 시간 측정
    - DNS 확인

#### traceroute/tracert
```bash
# Linux
traceroute google.com

# Windows
tracert google.com
```
- 제공 정보:
    - 목적지까지의 경로
    - 각 홉(hop)별 응답 시간
    - 네트워크 병목 구간 확인

### ip addr, ip route 등(리눅스 ip 명령어)

#### IP 주소 관리
```bash
# IP 주소 확인
ip addr show

# IP 주소 추가
ip addr add 192.168.1.10/24 dev eth0

# IP 주소 삭제
ip addr del 192.168.1.10/24 dev eth0
```

#### 라우팅 테이블 관리
```bash
# 라우팅 테이블 확인
ip route show

# 기본 게이트웨이 추가
ip route add default via 192.168.1.1

# 특정 네트워크 경로 추가
ip route add 10.0.0.0/24 via 192.168.1.254
```

## 요약 (Summary)

### IP 주소의 기본 개념
- IPv4: 32비트 주소 체계, 10진수 4개 옥텟으로 표현
- IPv6: 64비트 주소 체계, 16진수 8개 그룹으로 표현
- CIDR 표기법을 통한 유연한 네트워크 분할

### IP 주소 할당과 관리
- 사설 IP vs 공인 IP의 구분과 용도
- 고정 IP vs 동적 IP(DHCP)의 특징
- 효율적인 주소 관리를 위한 서브넷팅

### 주요 개념 정리
- 서브넷팅: 네트워크를 작은 단위로 분할하는 기술
- NAT: 사설 IP를 공인 IP로 변환하는 기술
- VLSM: 다양한 크기의 서브넷을 효율적으로 구성

### 실무 활용
- IP 설정 및 확인 명령어 숙지
- 네트워크 연결성 테스트 도구 활용
- 라우팅 테이블 관리 방법

## 참고 자료(References)

### RFC 문서
- RFC 791: IPv4 프로토콜
- RFC 2460: Ipv6 프로토콜
- RFC 1918: 사설 IP 주소 할당

### 추천 도서
- "TCP/IP Illustrated, Volume 1" - W. Richard Stevens
- "Computer Networks" - Andrew S. Tanenbaum
- "Network Warrior" - Gary A. Donahue

### 다음 학습 주제 안내
- TCP/UDP 상세 분석 (`03_tcp_udp_details.md`)
- HTTP/HTTPS 프로토콜 (`04_http_https.md`)
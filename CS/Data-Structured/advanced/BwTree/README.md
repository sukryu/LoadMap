# Bw Tree μλ£κµ¬μ΅° π“π—‚οΈ

Bw Treeλ” λ†’μ€ λ™μ‹μ„± ν™κ²½κ³Ό μΈλ©”λ¨λ¦¬ λ°μ΄ν„°λ² μ΄μ¤λ¥Ό μ„ν•΄ μ„¤κ³„λ λ½-ν”„λ¦¬(λ¬΄μ κΈ) B-νΈλ¦¬ κ³„μ—΄μ μΈλ±μ¤ μλ£κµ¬μ΅°μ…λ‹λ‹¤.  
μ „ν†µμ μΈ B-νΈλ¦¬μ™€ λ‹¬λ¦¬, Bw Treeλ” λ¬Όλ¦¬μ  ν¬μΈν„° λ€μ‹  λ§¤ν•‘ ν…μ΄λΈ”κ³Ό λΈνƒ€ λ μ½”λ“λ¥Ό ν™μ©ν•μ—¬ λ°μ΄ν„° μμ • μ΄λ ¥μ„ κ΄€λ¦¬ν•λ©°,  
μ›μμ  μ—°μ‚°(atomic CAS λ“±)μ„ ν†µν•΄ λ½ μ—†μ΄λ„ μ•μ „ν• λ™μ‹ μ ‘κ·Όμ„ λ³΄μ¥ν•©λ‹λ‹¤.

---

## λ©μ°¨ π“
1. [κ°μ”](#κ°μ”-π§)
2. [Bw Treeμ μ •μμ™€ νΉμ§•](#bw-treeμ-μ •μμ™€-νΉμ§•)
3. [λ©”λ¨λ¦¬ κµ¬μ΅° λ° λ‹¤μ΄μ–΄κ·Έλ¨](#λ©”λ¨λ¦¬-κµ¬μ΅°-λ°-λ‹¤μ΄μ–΄κ·Έλ¨-π–ΌοΈ)
4. [μ£Όμ” μ—°μ‚°](#μ£Όμ”-μ—°μ‚°-π› οΈ)
5. [μ¥λ‹¨μ ](#μ¥λ‹¨μ -β–οΈ)
6. [μ‹¤λ¬΄ ν™μ© μμ‹](#μ‹¤λ¬΄-ν™μ©-μμ‹-π’Ό)
7. [μ°Έκ³  μλ£](#μ°Έκ³ -μλ£-π”—)

---

## κ°μ” π§
Bw Treeλ” μΈλ©”λ¨λ¦¬ ν™κ²½μ—μ„ κ³ μ„±λ¥ λ™μ‹μ„± μΈλ±μ‹±μ„ λ©ν‘λ΅ ν•λ” λ½-ν”„λ¦¬ μλ£κµ¬μ΅°μ…λ‹λ‹¤.  
λ§¤ν•‘ ν…μ΄λΈ”(mapping table)κ³Ό λΈνƒ€ λ μ½”λ“(delta record)λ¥Ό μ‚¬μ©ν•μ—¬,  
λ°μ΄ν„° λ³€κ²½ μ‚¬ν•­μ„ λ΅κ·Έ ν•μ‹μΌλ΅ κΈ°λ΅ν•κ³  μ£ΌκΈ°μ μΌλ΅ λ³‘ν•©(consolidation)ν•¨μΌλ΅μ¨,  
μ κΈ μ—†μ΄λ„ μ•μ „ν•κ² λ‹¤μ¤‘ μ¤λ λ“μ μ½κΈ°/μ“°κΈ° μ‘μ—…μ„ μ§€μ›ν•©λ‹λ‹¤.

---

## Bw Treeμ μ •μμ™€ νΉμ§•
- **μ •μ**:  
  Bw Treeλ” μ „ν†µμ μΈ B-νΈλ¦¬ κµ¬μ΅°λ¥Ό κΈ°λ°μΌλ΅ ν•λ©΄μ„,  
  λ¬Όλ¦¬μ  ν¬μΈν„° λ€μ‹  λ…Όλ¦¬μ  λ§¤ν•‘ ν…μ΄λΈ”μ„ ν™μ©ν•΄ λ…Έλ“μ μ„μΉλ¥Ό κ΄€λ¦¬ν•κ³ ,  
  λ¨λ“  μμ • μ—°μ‚°(μ‚½μ…, μ‚­μ , μ—…λ°μ΄νΈ)μ€ λΈνƒ€ λ μ½”λ“λ΅ κΈ°λ΅λμ–΄  
  μ£ΌκΈ°μ μΈ λ³‘ν•© μ‘μ—…μ„ ν†µν•΄ μ •λ¦¬λλ” λ½-ν”„λ¦¬ μΈλ±μ¤μ…λ‹λ‹¤.
  
- **νΉμ§•**:
  - **λ½-ν”„λ¦¬ λ™μ‹μ„±**:  
    μ›μμ  μ—°μ‚°(μ: CAS)μ„ μ‚¬μ©ν•μ—¬, λ½ μ—†μ΄ μ—¬λ¬ μ¤λ λ“κ°€ λ™μ‹μ— μ ‘κ·Όν•  μ μμµλ‹λ‹¤.
  - **λ§¤ν•‘ ν…μ΄λΈ” κΈ°λ° κ΄€λ¦¬**:  
    λ…Έλ“ ν¬μΈν„° λ€μ‹  λ§¤ν•‘ ν…μ΄λΈ”μ„ μ‚¬μ©ν•΄, λ…Έλ“ λ³€κ²½ μ‹ μΌκ΄€μ„±μ„ μ μ§€ν•©λ‹λ‹¤.
  - **λΈνƒ€ λ μ½”λ“**:  
    λ¨λ“  μμ • μ‚¬ν•­μ„ λΈνƒ€ λ μ½”λ“λ΅ κΈ°λ΅ν•μ—¬, μ‹¤μ  λ…Έλ“ κµ¬μ΅°λ¥Ό λ³€κ²½ν•μ§€ μ•κ³ λ„ λΉ λ¥Έ μ—…λ°μ΄νΈκ°€ κ°€λ¥ν•©λ‹λ‹¤.
  - **μ£ΌκΈ°μ  λ³‘ν•©(consolidation)**:  
    λΈνƒ€ λ μ½”λ“λ“¤μ΄ λ„μ λλ©΄, μ΄λ¥Ό μ£ΌκΈ°μ μΌλ΅ λ³‘ν•©ν•μ—¬ νΈλ¦¬μ κµ¬μ΅°λ¥Ό μµμ ν™”ν•©λ‹λ‹¤.

---

## λ©”λ¨λ¦¬ κµ¬μ΅° λ° λ‹¤μ΄μ–΄κ·Έλ¨ π–ΌοΈ
Bw Treeμ λ©”λ¨λ¦¬ κµ¬μ΅°λ” ν¬κ² λ‘ λ¶€λ¶„μΌλ΅ λ‚λ‰©λ‹λ‹¤:
1. **λ§¤ν•‘ ν…μ΄λΈ”**:  
   κ° λ…Όλ¦¬μ  νμ΄μ§€(λ…Έλ“)μ μ„μΉλ¥Ό μ‹¤μ  λ©”λ¨λ¦¬ μ£Όμ†μ™€ μ—°κ²°ν•μ—¬ κ΄€λ¦¬ν•©λ‹λ‹¤.
2. **λΈνƒ€ λ μ½”λ“ μ²΄μΈ**:  
   κ° λ…Έλ“μ— λ€ν• μμ • μ‚¬ν•­(μ‚½μ…, μ‚­μ , μ—…λ°μ΄νΈ)μ΄ λΈνƒ€ λ μ½”λ“ ν•νƒλ΅ κΈ°λ΅λλ©°,  
   λ„μ λ λΈνƒ€ λ μ½”λ“λ“¤μ€ μ£ΌκΈ°μ μΌλ΅ λ³‘ν•©λμ–΄ κΈ°λ³Έ λ…Έλ“(base node)λ¥Ό κ°±μ‹ ν•©λ‹λ‹¤.

```mermaid
flowchart TD
    A[λ§¤ν•‘ ν…μ΄λΈ”]
    B[κΈ°λ³Έ λ…Έλ“(Base Node)]
    C[λΈνƒ€ λ μ½”λ“ 1]
    D[λΈνƒ€ λ μ½”λ“ 2]
    E[λΈνƒ€ λ μ½”λ“ 3]
    A --> B
    B --> C
    C --> D
    D --> E
```

---

## μ£Όμ” μ—°μ‚° π› οΈ
- **μ‚½μ… (Insertion)**:  
  μƒ ν‚¤-κ°’ μμ€ ν•΄λ‹Ή λ…Έλ“μ λΈνƒ€ λ μ½”λ“λ΅ κΈ°λ΅λλ©°,  
  λ§¤ν•‘ ν…μ΄λΈ”μ„ ν†µν•΄ λ…Όλ¦¬μ  μ„μΉλ¥Ό κ΄€λ¦¬ν•©λ‹λ‹¤.
  
- **μ‚­μ  (Deletion)**:  
  μ‚­μ  μ—°μ‚° μ—­μ‹ λΈνƒ€ λ μ½”λ“λ΅ κΈ°λ΅λμ–΄,  
  κΈ°μ΅΄ λ°μ΄ν„°μ— λ€ν• μ‚­μ  λ§μ»¤λ¥Ό λ‚¨κΈ°κ³  μ£ΌκΈ°μ  λ³‘ν•© μ‹ μ‹¤μ  μ‚­μ κ°€ λ°μλ©λ‹λ‹¤.
  
- **κ²€μƒ‰ (Search)**:  
  λ§¤ν•‘ ν…μ΄λΈ”μ„ κΈ°λ°μΌλ΅ λ…Έλ“λ¥Ό μ°Ύμ•„,  
  κΈ°λ³Έ λ…Έλ“μ™€ λ„μ λ λΈνƒ€ λ μ½”λ“λ¥Ό μμ°¨μ μΌλ΅ μ μ©ν•μ—¬ μµμ‹  μƒνƒμ κ°’μ„ λ°ν™ν•©λ‹λ‹¤.
  
- **λ³‘ν•© (Consolidation)**:  
  λ„μ λ λΈνƒ€ λ μ½”λ“κ°€ μΌμ • μ„κ³„μΉλ¥Ό λ„μΌλ©΄,  
  μ΄λ¥Ό λ³‘ν•©ν•μ—¬ κΈ°λ³Έ λ…Έλ“λ¥Ό κ°±μ‹ ν•κ³ , λ§¤ν•‘ ν…μ΄λΈ”μ„ μ—…λ°μ΄νΈν•©λ‹λ‹¤.

---

## μ¥λ‹¨μ  β–οΈ

### μ¥μ  π‘
- **λ†’μ€ λ™μ‹μ„±**:  
  λ½-ν”„λ¦¬ μ„¤κ³„λ΅ λ‹¤μ¤‘ μ¤λ λ“ ν™κ²½μ—μ„ ν¨μ¨μ μΈ λ™μ‹ μ ‘κ·Όμ„ μ§€μ›ν•©λ‹λ‹¤.
- **λΉ λ¥Έ μ—…λ°μ΄νΈ**:  
  λΈνƒ€ λ μ½”λ“λ¥Ό ν†µν• λΉ„νκ΄΄μ  μμ •μΌλ΅ λΉ λ¥Έ μ“°κΈ° μ„±λ¥μ„ μ κ³µν•©λ‹λ‹¤.
- **λ©”λ¨λ¦¬ ν¨μ¨μ„±**:  
  λ§¤ν•‘ ν…μ΄λΈ”κ³Ό λΈνƒ€ λ μ½”λ“λ¥Ό ν™μ©ν•μ—¬, ν•„μ” μ‹μ—λ§ λ…Έλ“ λ³‘ν•©μ„ μν–‰ν•¨μΌλ΅μ¨  
  λ¶ν•„μ”ν• λ©”λ¨λ¦¬ λ³µμ‚¬λ¥Ό μ¤„μ…λ‹λ‹¤.

### λ‹¨μ  π‘
- **λ³µμ΅ν• κµ¬ν„**:  
  λ§¤ν•‘ ν…μ΄λΈ”, λΈνƒ€ λ μ½”λ“, κ·Έλ¦¬κ³  μ£ΌκΈ°μ  λ³‘ν•© λ“±μ κ΄€λ¦¬ λ΅μ§μ΄ λ³µμ΅ν•©λ‹λ‹¤.
- **λ³‘ν•© μ¤λ²„ν—¤λ“**:  
  λΈνƒ€ λ μ½”λ“κ°€ λ„μ λ  κ²½μ° λ³‘ν•© μ‘μ—…μΌλ΅ μΈν• μ¤λ²„ν—¤λ“κ°€ λ°μƒν•  μ μμµλ‹λ‹¤.
- **λ””λ²„κΉ… μ–΄λ ¤μ›€**:  
  λ½-ν”„λ¦¬ λ° λΉ„νκ΄΄μ  μμ • λ°©μ‹μ€ λ””λ²„κΉ… λ° ν…μ¤νΈκ°€ μƒλ€μ μΌλ΅ μ–΄λ µμµλ‹λ‹¤.

---

## μ‹¤λ¬΄ ν™μ© μμ‹ π’Ό
- **μΈλ©”λ¨λ¦¬ λ°μ΄ν„°λ² μ΄μ¤**:  
  SQL Serverμ μΈλ©”λ¨λ¦¬ OLTP μ—”μ§„ λ“±, λ†’μ€ λ™μ‹μ„± ν™κ²½μ—μ„ μ‚¬μ©λ©λ‹λ‹¤.
- **κ³ μ„±λ¥ μΊμ‹ μ‹μ¤ν…**:  
  λ½ μ—†μ΄ λΉ λ¥Έ κ²€μƒ‰ λ° μ—…λ°μ΄νΈκ°€ ν•„μ”ν• μΊμ‹ μΈλ±μ¤λ΅ ν™μ©λ©λ‹λ‹¤.
- **μ‹¤μ‹κ°„ λ¶„μ„ μ‹μ¤ν…**:  
  λ€λ‰μ λ°μ΄ν„° μ—…λ°μ΄νΈμ™€ λΉ λ¥Έ μΏΌλ¦¬ μ²λ¦¬κ°€ μ”κµ¬λλ” μ‹μ¤ν…μ—μ„ μ±„νƒλ©λ‹λ‹¤.

---

## μ°Έκ³  μλ£ π”—
- [Bw-Tree: A Latch-Free B-Tree](https://www.microsoft.com/en-us/research/wp-content/uploads/2016/02/tr-2007-144.pdf)
- [High Performance Concurrency Control Mechanisms for Main-Memory Databases](https://www.microsoft.com/en-us/research/publication/high-performance-concurrency-control-mechanisms-for-main-memory-databases/)
- [Bw-Tree κ΄€λ ¨ κΈ°μ  μλ£ λ° λ°ν‘ μλ£](https://www.microsoft.com/en-us/research/)

---

Bw Treeμ κµ¬μ΅°μ™€ μ•κ³ λ¦¬μ¦μ„ μ΄ν•΄ν•λ©΄,  
κ³ μ„±λ¥ μΈλ©”λ¨λ¦¬ λ°μ΄ν„°λ² μ΄μ¤ λ° λ™μ‹μ„± μ§‘μ•½μ  μ‘μ© ν”„λ΅κ·Έλ¨μ—μ„  
λ½ μ—†μ΄ λΉ λ¥Έ κ²€μƒ‰κ³Ό μ—…λ°μ΄νΈ, κ·Έλ¦¬κ³  ν¨μ¨μ μΈ μΈλ±μ¤ κ΄€λ¦¬λ¥Ό κµ¬ν„ν•  μ μμµλ‹λ‹¤.
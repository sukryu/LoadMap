# 전자상거래 플랫폼 완성하기. (백엔드)

* 위 프로젝트는 전자 상거래 플랫폼을 작성하기 위한 기초적인 계획을 보여줍니다. 우리는 고성능과 확장성을 추구하고 프로젝트를 완성하기 위해 끈기 있게 지속할 것을 약속하겠습니다.

* 기술 스택은 다음과 같습니다.
    - 언어: Golang(go version go1.23.3 linux/amd64)
    - 프레임워크: fiber(`fasthttp`를 기반으로 하고 있기 때문에 Benchmark를 휩쓸고 있고 우리 프로젝트에서 추구하는 고성능에 부합함.)
    - 데이터베이스: PostgreSQL(오픈소스?이며 굉장한 성능의 RDBMS이고, 전세계에서 가장 많이 쓰이는 RDBMS중 하나이기에 선택했다.)
    - 캐싱: Redis(키-값 저장소로 굉장히 빠른 성능을 보유하고 있기 때문에 캐싱에 딱이다.)
    - API:
        - 외부: RESTful API (모바일과 다른 웹 서비스와 연동할 때 필요할 수도 있기 때문.)
        - 내부: gRPC + Kafka (내부 서비스 통신에는 gRPC와 Kafka를 하이브리드로 사용합니다.)
        * 외부 API는 API Gateway에서 노출하며 API Gateway는 각 마이크로서비스에게 요청을 라우팅하는 역할을 합니다.

* 요청 흐름
    - 외부에서 특정 동작 -> API 게이트웨이(인증 및 인가 수행) -> 내부 서비스 -> API 게이트웨이 식으로 흘러갑니다.
    - **중간에 로드밸런서와 각종 보안 요소, 서비스 메시등이 탑재될 수도 있습니다.**

* 서비스 간 데이터 동기화 기법
    - 데이터 동기화 기법으로는 모든 마이크로서비스들이 특정 도메인을 구독하도록 하여 Kafka로 이벤트를 발행하여 성공 및 실패 여부를 통해 동기화 하도록 지원.

## 아키텍처 설계

* 처음에는 외부 -> API 게이트웨이(RESTful API + gRPC + Kafka) -> 내부 모놀릭 서버식으로 구성됩니다.
    - API 게이트웨이: 사용자 인증 및 인가와 RBAC 등을 담당하고 모든 요청에 대해 해당 역할을 수행합니다.
        - 또한 Rate Limit, JWT 검증, Logging 처리 등을 수행합니다.
    - 내부 모놀릭 서버: 처음에는 규모가 크지 않기 때문에 사용자 관리, 상품 및 재고 관리, 리뷰 관리, 결제 관리 이런 식으로 내부적으로 모듈이 나누어져 설계될 예정입니다.

* 모든 서비스가 동일한 데이터베이스를 공유: 처음에는 하나의 PostgreSQL과 Redis를 두며 내부 모놀릭 서버에서 모두 동일한 데이터베이스를 사용합니다.

## 배포 환경

* 로컬 개발환경(Dev)
    - Docker Compose로 간단히 PostgreSQL, Redis, Kafka와 API 게이트웨이, 내부 모놀릭 서버를 컨테이너로 구동.
    - 개발용 .env 또는 .yaml 파일, 테스트 DB

* 스테이징(Stage) 환경
    - Azure에 스테이징용 VM이 구성되어 있음. 여기에서 minikube를 사용해서 k8s를 구성할 예정(예산 부족 이슈).
    - CI/CD 파이프라인: Github Action과 ArgoCD를 통해서 자동으로 빌드 후 스테이징 배포
    - PostgreSQL, Redis, Kafka도 위의 VM에서 구동할 예정. 이 또한 예산 부족 이슈.

* 프로덕션(Prod) 환경
    - 아직 미정.

## 내부 서비스 정의
[내부 서비스 정의](service-spec.md)

## 이벤트 정의
[이벤트 정의](event-spec.md)

## API 정의
[API 정의](api-spec.md)

## 데이터베이스 스키마 정의
[스키마 정의](schema-spec.md)
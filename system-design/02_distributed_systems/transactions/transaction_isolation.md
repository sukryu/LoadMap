# 트랜잭션 격리 수준 (Transaction Isolation Levels)

> **목표:**  
> - 데이터베이스 트랜잭션에서 동시에 발생하는 작업 간의 간섭을 제어하기 위한 격리 수준의 개념을 이해한다.  
> - Read Uncommitted, Read Committed, Repeatable Read, Serializable 등 각 격리 수준이 보장하는 데이터 정합성의 정도와 발생 가능한 동시성 문제(Dirty Read, Non-Repeatable Read, Phantom Read 등)를 분석한다.  
> - 분산 시스템 및 대규모 애플리케이션에서 적절한 격리 수준을 선택하는 방법과 그에 따른 트레이드오프를 학습한다.

---

## 1. 개념 개요

> **트랜잭션 격리 수준은 데이터베이스에서 다수의 트랜잭션이 동시에 실행될 때, 서로 간섭하지 않고 올바른 결과를 보장하기 위해 각 트랜잭션의 변경사항이 다른 트랜잭션에 어떻게 보이는지를 제어하는 기준이다.**

- **정의:**  
  - 트랜잭션 격리 수준은 여러 트랜잭션이 동시에 수행될 때 발생할 수 있는 부정합(데이터 충돌, 불일치)을 방지하기 위해, 각 트랜잭션이 다른 트랜잭션의 중간 상태를 볼 수 있는지 여부와, 커밋된 변경사항이 언제 반영되는지를 규정합니다.

- **왜 중요한가?**  
  - **데이터 정합성 유지:** 격리 수준을 통해 동시에 실행되는 트랜잭션 간의 상호 작용을 제어함으로써, 데이터의 정확성과 일관성을 보장합니다.
  - **동시성 제어:** 높은 동시성이 요구되는 환경에서도 성능 저하 없이 데이터 충돌을 방지할 수 있도록 지원합니다.
  - **응용 시스템의 특성 반영:** 애플리케이션에 따라 최신 데이터의 즉각 반영이 필요할 수도 있고, 일부 지연을 감수하더라도 동시성 처리 성능이 중요한 경우가 있으므로, 적절한 격리 수준 선택이 필수적입니다.

- **어떤 문제를 해결하는가?**  
  - **Dirty Read:** 커밋되지 않은 데이터를 다른 트랜잭션이 읽는 문제를 방지합니다.
  - **Non-Repeatable Read:** 한 트랜잭션 내에서 같은 쿼리 결과가 여러 번 실행 시 달라지는 문제를 제어합니다.
  - **Phantom Read:** 한 트랜잭션에서 실행한 쿼리에 새 행이 추가되거나 삭제되어 결과 집합이 달라지는 현상을 방지합니다.

---

## 2. 주요 트랜잭션 격리 수준

데이터베이스 시스템에서는 일반적으로 다음과 같은 네 가지 격리 수준을 제공합니다.

### 2.1 Read Uncommitted
- **개념:**  
  - 가장 낮은 격리 수준으로, 한 트랜잭션에서 커밋되지 않은 데이터를 다른 트랜잭션이 읽을 수 있습니다.
- **특징:**  
  - **Dirty Read 발생 가능:** 커밋되지 않은 변경사항을 읽어 데이터 부정합이 발생할 수 있습니다.
  - **최대 동시성:** 성능 측면에서는 가장 높은 동시성을 제공합니다.
- **사용 예:**  
  - 데이터 정합성이 그리 중요하지 않은 로그 기록이나 통계 수집 등에서 사용할 수 있으나, 금융이나 주문 처리와 같이 정확한 데이터가 필요한 경우에는 부적합합니다.

### 2.2 Read Committed
- **개념:**  
  - 각 트랜잭션은 커밋된 데이터만 읽을 수 있으며, Dirty Read를 방지합니다.
- **특징:**  
  - **Non-Repeatable Read 및 Phantom Read 발생 가능:** 동일 트랜잭션 내에서 동일한 쿼리를 재실행할 때 결과가 달라질 수 있습니다.
  - **적당한 동시성 및 성능:** 대부분의 애플리케이션에서 기본적으로 선택되는 격리 수준입니다.
- **사용 예:**  
  - 일반적인 OLTP(Online Transaction Processing) 시스템에서 널리 사용되며, 데이터 정합성과 성능 사이의 균형을 이룹니다.

### 2.3 Repeatable Read
- **개념:**  
  - 한 트랜잭션 내에서 같은 데이터를 여러 번 읽더라도 결과가 일관되도록 보장합니다.
- **특징:**  
  - **Non-Repeatable Read 방지:** 한 트랜잭션 내에서 데이터가 변경되지 않음을 보장하지만, Phantom Read는 여전히 발생할 수 있습니다.
  - **격리 수준 상승:** 데이터 정합성을 강화하지만, 성능 측면에서는 추가 오버헤드가 발생할 수 있습니다.
- **사용 예:**  
  - 트랜잭션 내에서 동일한 데이터에 대해 여러 번 읽기가 필요한 애플리케이션에 적합합니다.

### 2.4 Serializable
- **개념:**  
  - 가장 높은 격리 수준으로, 모든 트랜잭션이 직렬로 실행된 것처럼 동작하도록 보장합니다.
- **특징:**  
  - **모든 동시성 문제 제거:** Dirty Read, Non-Repeatable Read, Phantom Read 모두 방지합니다.
  - **낮은 동시성 및 성능 저하:** 모든 트랜잭션을 직렬화하기 때문에 동시 실행이 제한되고, 성능이 크게 저하될 수 있습니다.
- **사용 예:**  
  - 데이터 정합성이 극도로 중요한 금융 거래 시스템이나 고신뢰성이 요구되는 업무에 사용되지만, 높은 성능이 요구되는 환경에서는 부적합할 수 있습니다.

---

## 3. 실무 적용 및 고려 사항

- **애플리케이션 요구사항 분석:**  
  - 데이터 정합성 요구사항, 응답 시간, 동시성 수준 등을 고려하여 적절한 격리 수준을 선택해야 합니다.
  - 예를 들어, 주문 처리와 같이 데이터 변경의 정확성이 중요한 경우 Repeatable Read나 Serializable을, 빠른 응답이 필요한 경우 Read Committed을 선택할 수 있습니다.

- **성능과 트레이드오프:**  
  - 높은 격리 수준은 데이터 정합성을 강화하지만, 동시에 성능 저하와 동시성 감소를 초래할 수 있습니다.  
  - 분산 시스템 환경에서는 네트워크 지연 및 노드 간 동기화 비용도 고려해야 합니다.

- **데이터베이스 및 미들웨어 기능 활용:**  
  - 대부분의 데이터베이스 시스템은 격리 수준을 설정하는 기능을 제공하므로, 애플리케이션 특성에 맞게 설정하고, 필요 시 동적으로 조정할 수 있습니다.
  
- **테스트 및 모니터링:**  
  - 격리 수준 변경에 따른 동시성 문제 및 데이터 불일치 상황을 시뮬레이션하고, 모니터링 도구를 통해 실제 운영 환경에서의 동작을 검증해야 합니다.

---

## 4. 참고 자료

- 📖 _Designing Data-Intensive Applications_ - Martin Kleppmann  
- 📖 _Distributed Systems: Principles and Paradigms_ - Andrew S. Tanenbaum  
- 온라인 자료: [Transaction Isolation Levels Explained](https://www.ibm.com/docs/en/db2/11.5?topic=transactions-isolation-levels)

---

## 5. 마무리

트랜잭션 격리 수준은 데이터베이스와 분산 시스템에서 데이터 정합성과 동시성을 균형 있게 유지하기 위한 중요한 기법입니다.  
각 격리 수준은 서로 다른 동시성 문제와 성능 트레이드오프를 가지므로, 애플리케이션의 요구사항에 맞춰 적절한 수준을 선택하는 것이 필수적입니다.  
이 문서를 통해 Read Uncommitted, Read Committed, Repeatable Read, Serializable 등 각 격리 수준의 특징과 실무 적용 시 고려해야 할 사항들을 명확히 이해하고, 안정적이고 효율적인 시스템 설계를 도모할 수 있기를 바랍니다.